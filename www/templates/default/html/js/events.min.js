require(["jquery","wdn","modernizr"],function(t,e,n){"use strict";var a=t("<progress>"),o="(min-width: 768px)";window.location;t(function(){var r,i,c,l,u=t("link[rel=home]"),h=t("#script_main"),s=t(".wp-calendar"),d="day";function f(t,e){window.history.pushState&&window.location.href!==t&&window.history.pushState({route:e},"",t)}function g(){i=new Date(s.data("datetime"));var e=new Date,n=i.getMonth(),a=i.getFullYear(),o=t("td",s);o.removeClass("today active"),a===e.getFullYear()&&n===e.getMonth()&&o.not(".prev,.next").each(function(){if(t.trim(t(this).text())==e.getDate())return t(this).addClass("today"),!1}),a==c.getFullYear()&&n==c.getMonth()&&o.not(".prev,.next").each(function(){if(t.trim(t(this).text())==c.getDate())return t(this).addClass("active"),!1})}function v(t){w(),a.hide(),l=setTimeout(function(){a.prependTo(t),a.fadeIn(200)},1e3)}function w(){clearTimeout(l)}function m(){var e=t("h1").data("datetime");c=e?new Date(e):new Date}function p(e){var n,a=t("aside .calendar");n=e instanceof Date?u+e.getFullYear()+"/"+(e.getMonth()+1)+"/":e,v(a),t.get(n+"?monthwidget&format=hcalendar",function(e){w(),a.html(e),s=t(".wp-calendar"),g()})}function D(e){var n,a=new Date,o=t("#updatecontent");f(n=e instanceof Date?u+e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+"/":e,"day");var r="format=hcalendar";"?"===n.charAt(n.length-1)?n+=r:n=n.indexOf("?")>0?n+"&"+r:n+"?"+r,v(o),t.get(n,function(e){w(),o.html(e),m(),c.getFullYear()==a.getFullYear()&&c.getMonth()==a.getMonth()&&c.getDate()==a.getDate()&&(window.location=window.location),i.getFullYear()!==c.getFullYear()||i.getMonth()!==c.getMonth()?p(c):g(),c.getFullYear()==a.getFullYear()&&c.getMonth()==a.getMonth()&&c.getDate()==a.getDate()?t("#events-promo-bar").show():t("#events-promo-bar").hide()})}function y(e){var n=t("#updatecontent");f(e,"event"),v(n),t.get(e+"?format=hcalendar",function(t){w(),n.html(t)})}function M(t,e){var n=new Date(t);return n.setMonth(n.getMonth()+e),n.getDate()<t.getDate()&&n.setDate(0),n}u=u.length?u[0].href:"/",h=h.length?e.toAbs("./",h[0].src):"/templates/default/html/js/",(r=t("aside .calendar")).length&&(m(),g(),r.on("click","td a",function(t){t.preventDefault(),D(this.href)}),r.on("click",".next a, .prev a",function(t){t.preventDefault(),p(this.href)})),t(".view-unl_ucbcn_frontend_eventinstance").length?d="event":t(".view-unl_ucbcn_frontend_search").length&&(d="search"),t(document).on("keyup",function(e){if(!t(e.target).is("input, select, textarea, button")){var n=t(".day-nav");if(n.length)switch(e.which){case 39:D(e.altKey?M(c,1):t(".next",n).attr("href"));break;case 37:D(e.altKey?M(c,-1):t(".prev",n).attr("href"))}}}),t("#updatecontent").on("click",".vevent a.summary",function(t){t.preventDefault(),y(this.href)}),t(window).on("popstate",function(e){var n,a,o=e.originalEvent.state&&e.originalEvent.state.route||d,r=window.location.href;if(null===e.originalEvent.state)return event.preventDefault(),!1;switch(o){case"event":y(r);break;case"day":D(r);break;case"search":n=r,a=t("#updatecontent"),f(n,"search"),v(a),t.get(n+(-1==n.indexOf("?")?"?":"&")+"format=hcalendar",function(t){w(),a.html(t)})}}),t(window).on("resize",function(){n.mediaqueries&&n.mq(o)})})});